<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindmap Brainstorm Tool</title>
    <!-- CSS bestanden -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="header">
        <h1>Mindmap Brainstorm Tool</h1>
        <div class="button-group">
            <button class="btn btn-save" id="save-btn" title="Sla de mindmap op als bestand">Opslaan</button>
            <button class="btn btn-save" id="load-btn" title="Laad een opgeslagen mindmap">Laden</button>
            <button class="btn btn-export" id="export-mermaid-btn" title="Exporteer naar Mermaid syntax">Exporteer naar Mermaid</button>
            <button class="btn btn-import" id="import-mermaid-btn" title="Importeer een Mermaid diagram">Importeer van Mermaid</button>
            <button class="btn btn-save" id="export-image-btn" title="Sla op als afbeelding">Exporteer als Afbeelding</button>
            <button class="btn btn-layout" id="auto-layout-btn" title="Automatisch organiseren">Auto-Layout</button>
            <button class="btn" id="center-btn" title="Centreer de mindmap">Centreren</button>
            <button class="btn" id="clear-btn" title="Wis de mindmap">Wissen</button>
            <button class="btn" id="help-btn" title="Toon help">Help</button>
        </div>
    </div>
    
    <div class="main-container">
        <div class="toolbar">
            <button class="tool-btn active" id="select-tool" title="Selecteer en verplaats (S)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"></path>
                </svg>
            </button>
            <button class="tool-btn" id="add-node-tool" title="Voeg knooppunt toe (A)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
            </button>
            <button class="tool-btn" id="connect-tool" title="Verbind knooppunten (C)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                    <polyline points="15 3 21 3 21 9"></polyline>
                    <line x1="10" y1="14" x2="21" y2="3"></line>
                </svg>
            </button>
            <div class="tool-divider"></div>
            <button class="tool-btn" id="delete-tool" title="Verwijder element (D)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
            </button>
            <div class="tool-divider"></div>
            <button class="tool-btn" id="undo-btn" title="Ongedaan maken (Ctrl+Z)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 10h10a8 8 0 0 1 8 8v2M3 10l6 6M3 10l6-6"></path>
                </svg>
            </button>
            <div class="tool-divider"></div>
            <button class="tool-btn" id="toggle-grid-btn" title="Raster aan/uit (G)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="3" y1="9" x2="21" y2="9"></line>
                    <line x1="3" y1="15" x2="21" y2="15"></line>
                    <line x1="9" y1="3" x2="9" y2="21"></line>
                    <line x1="15" y1="3" x2="15" y2="21"></line>
                </svg>
            </button>
            <button class="tool-btn" id="toggle-minimap-btn" title="Minimap aan/uit (M)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <rect x="7" y="7" width="10" height="10" rx="1" ry="1"></rect>
                </svg>
            </button>
        </div>
        
        <div class="canvas-container">
            <div id="mindmap-canvas"></div>
            
            <div class="mini-map" id="mini-map">
                <div class="mini-map-content" id="mini-map-content">
                    <div class="mini-map-viewport" id="mini-map-viewport"></div>
                </div>
            </div>
            
            <div class="zoom-controls">
                <button class="zoom-btn" id="zoom-in" title="Zoom in">+</button>
                <div class="zoom-level" id="zoom-level">100%</div>
                <button class="zoom-btn" id="zoom-out" title="Zoom uit">−</button>
                <button class="zoom-btn" id="zoom-reset" title="Reset zoom">⟳</button>
            </div>
        </div>
    </div>
    
    <!-- Knooppunt bewerken modal -->
    <div class="modal" id="node-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Knooppunt Bewerken</div>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="node-title">Titel:</label>
                    <input type="text" id="node-title" placeholder="Voer een titel in">
                </div>
                <div class="form-group">
                    <label for="node-content">Inhoud (optioneel):</label>
                    <textarea id="node-content" placeholder="Voer inhoud in (optioneel)"></textarea>
                </div>
                <div class="form-group">
                    <label for="node-color">Kleur:</label>
                    <input type="color" id="node-color" value="#4CAF50">
                </div>
                <div class="form-group">
                    <label for="node-shape">Vorm:</label>
                    <select id="node-shape">
                        <option value="rectangle">Rechthoek</option>
                        <option value="rounded">Afgerond</option>
                        <option value="circle">Cirkel</option>
                        <option value="diamond">Ruit</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancel-node-edit">Annuleren</button>
                <button class="btn btn-save" id="save-node-edit">Opslaan</button>
            </div>
        </div>
    </div>
    
    <!-- Verbinding bewerken modal -->
    <div class="modal" id="connection-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Verbinding Bewerken</div>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="connection-label">Label:</label>
                    <input type="text" id="connection-label" placeholder="Voer een label in (optioneel)">
                </div>
                <div class="form-group">
                    <label for="connection-style">Lijnstijl:</label>
                    <select id="connection-style">
                        <option value="solid">Doorgetrokken</option>
                        <option value="dashed">Gestippeld</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="connection-type">Type verbinding:</label>
                    <select id="connection-type">
                        <option value="default">Standaard</option>
                        <option value="primary">Primair</option>
                        <option value="secondary">Secundair</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancel-connection-edit">Annuleren</button>
                <button class="btn btn-save" id="save-connection-edit">Opslaan</button>
            </div>
        </div>
    </div>
    
    <!-- Export modal -->
    <div class="modal" id="export-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Exporteren naar Mermaid</div>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Gebruik onderstaande Mermaid code in de Mermaid Live Editor:</p>
                <textarea id="export-content" readonly></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-export" id="copy-export">Kopiëren</button>
                <button class="btn" id="close-export">Sluiten</button>
            </div>
        </div>
    </div>
    
    <!-- Import modal -->
    <div class="modal" id="import-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Importeren van Mermaid</div>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Plak hieronder de Mermaid code:</p>
                <textarea id="import-content" placeholder="Plak hier de Mermaid code..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancel-import">Annuleren</button>
                <button class="btn btn-import" id="confirm-import">Importeren</button>
            </div>
        </div>
    </div>
    
    <!-- Help modal -->
    <div class="modal" id="help-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Help</div>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <h3>Mindmap Brainstorm Tool Gebruiksaanwijzing</h3>
                
                <h4>Basisgereedschappen:</h4>
                <ul>
                    <li><strong>Navigatie:</strong> Klik en sleep met de muis om knooppunten te verplaatsen.</li>
                    <li><strong>Nieuw knooppunt:</strong> Dubbelklik op een lege plaats in het canvas om een nieuw knooppunt toe te voegen.</li>
                    <li><strong>Knooppunt toevoegen vanaf bestaand knooppunt:</strong> Gebruik de plus (+) knoppen die verschijnen wanneer je over een bestaand knooppunt gaat.</li>
                    <li><strong>Rechtsklik menu:</strong> Toegang tot verschillende opties zoals hernoemen, bewerken, Y-vertakkingen maken, etc.</li>
                </ul>
                
                <h4>Directe interactie:</h4>
                <ul>
                    <li><strong>Titel bewerken:</strong> Dubbelklik op de titel van een knooppunt om deze direct te bewerken.</li>
                    <li><strong>Verbindingen:</strong> Rechtsklik op een knooppunt en kies "Y-vertakking maken" om het te verbinden met andere knooppunten.</li>
                    <li><strong>Verbindingen bewerken:</strong> Rechtsklik op een verbinding om opties te zien zoals vertakking maken of verwijderen.</li>
                    <li><strong>Verbindingslabels:</strong> Dubbelklik op een verbinding om een label toe te voegen.</li>
                    <li><strong>Snelle vertakking:</strong> Klik op het punt dat verschijnt wanneer je over een verbinding gaat om een Y-vertakking te maken.</li>
                    <li><strong>Verbindingen aanpassen:</strong> Sleep aan het oranje controlepunt om de vorm van een verbinding aan te passen.</li>
                    <li><strong>Tussennode toevoegen:</strong> Klik op het groene plusje op een verbindingslijn om een tussennode te maken.</li>
                </ul>
                
                <h4>Canvas Navigatie:</h4>
                <ul>
                    <li><strong>Pannen:</strong> Houd de spatiebalk of middelste muisknop ingedrukt en sleep om het canvas te verplaatsen.</li>
                    <li><strong>Zoomen:</strong> Gebruik het muiswiel of de zoom-knoppen linksonder om in/uit te zoomen.</li>
                    <li><strong>Centreren:</strong> Klik op de "Centreren" knop om de mindmap te centreren.</li>
                    <li><strong>Raster Aan/Uit (G):</strong> Schakel het achtergrond raster aan of uit.</li>
                    <li><strong>Minimap Aan/Uit (M):</strong> Toon of verberg de minimap rechtsonder.</li>
                    <li><strong>Auto-Layout:</strong> Gebruik de "Auto-Layout" knop om de mindmap automatisch te organiseren.</li>
                </ul>
                
                <h4>Sneltoetsen:</h4>
                <ul>
                    <li><strong>S:</strong> Selecteer tool</li>
                    <li><strong>A:</strong> Voeg knooppunt toe tool</li>
                    <li><strong>C:</strong> Verbind tool</li>
                    <li><strong>D:</strong> Verwijder tool</li>
                    <li><strong>G:</strong> Raster aan/uit</li>
                    <li><strong>M:</strong> Minimap aan/uit</li>
                    <li><strong>Spatiebalk (houden):</strong> Tijdelijke pan modus</li>
                    <li><strong>Delete/Backspace:</strong> Verwijder geselecteerd element</li>
                    <li><strong>Ctrl+Z:</strong> Ongedaan maken</li>
                    <li><strong>Ctrl+S:</strong> Opslaan</li>
                    <li><strong>Ctrl+O:</strong> Laden</li>
                    <li><strong>Ctrl+E:</strong> Exporteren naar Mermaid</li>
                    <li><strong>Ctrl+I:</strong> Importeren van Mermaid</li>
                    <li><strong>Ctrl+klik op knooppunt:</strong> Verbind met geselecteerd knooppunt</li>
                    <li><strong>Ctrl+klik (houden):</strong> Selecteer meerdere knooppunten om te verbinden</li>
                </ul>
                
                <h4>Export & Import:</h4>
                <ul>
                    <li>Gebruik "Exporteer naar Mermaid" om de mindmap te exporteren naar Mermaid-syntax voor gebruik in de Mermaid Live Editor.</li>
                    <li>Gebruik "Importeer van Mermaid" om Mermaid code te importeren en om te zetten naar een mindmap.</li>
                    <li>Gebruik "Als Afbeelding" om de mindmap als PNG-bestand op te slaan.</li>
                    <li>Gebruik "Opslaan" om het volledige mindmap-project als JSON-bestand op te slaan voor later gebruik.</li>
                </ul>
                
                <h4>Tips & Trucs:</h4>
                <ul>
                    <li><strong>Eerste gebruik tips:</strong> Bij het eerste gebruik zie je automatisch handige tips. Deze kun je altijd opnieuw bekijken met onderstaande knop.</li>
                    <li><strong>Tips uitgeschakeld?</strong> Als je de tips per ongeluk hebt uitgeschakeld, klik dan op "Toon Beginners Tips" hieronder.</li>
                    <li><strong>Snel werken:</strong> Gebruik de + knoppen op knooppunten voor het snel toevoegen van nieuwe ideeën.</li>
                    <li><strong>Organiseren:</strong> Sleep knooppunten om je mindmap overzichtelijk te houden.</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="show-tips-btn">Toon Beginners Tips</button>
                <button class="btn" id="close-help">Sluiten</button>
            </div>
        </div>
    </div>
    
    <!-- Context menu -->
    <div class="context-menu" id="context-menu">
        <div class="context-menu-item" id="context-edit">Bewerken</div>
        <div class="context-menu-item" id="context-rename">Hernoemen</div>
        <div class="context-menu-item" id="context-create-child">Nieuw subknooppunt</div>
        <div class="context-menu-item" id="context-branch">Y-vertakking maken</div>
        <div class="context-menu-item" id="context-set-root">Als hoofdknooppunt instellen</div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="context-delete">Verwijderen</div>
    </div>
    
    <!-- Verbinding context menu -->
    <div class="context-menu" id="connection-context-menu">
        <div class="context-menu-item" id="connection-edit">Bewerken</div>
        <div class="context-menu-item" id="connection-branch">Vertakking maken</div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="connection-style-solid">Stijl: Doorgetrokken</div>
        <div class="context-menu-item" id="connection-style-dashed">Stijl: Gestippeld</div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="connection-type-default">Type: Standaard</div>
        <div class="context-menu-item" id="connection-type-primary">Type: Primair</div>
        <div class="context-menu-item" id="connection-type-secondary">Type: Secundair</div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="connection-delete">Verwijderen</div>
    </div>
    
    <!-- Toast notificatie -->
    <div class="toast" id="toast"></div>
    
    <!-- Verborgen file input -->
    <input type="file" id="file-input" accept=".json">
    
    <!-- JavaScript bestanden -->
    <script src="js/module-loader.js"></script>
    <script src="js/core.js"></script>
    <script src="js/nodes.js"></script>
    <!-- Connection modules in correct order -->
    <script src="js/connections/geometry.js"></script>
    <script src="js/connections/utils.js"></script>
    <script src="js/connections/core.js"></script>
    <script src="js/connections/branches.js"></script>
    <script src="js/connections/rendering.js"></script>
    <script src="js/connections/interaction.js"></script>
    <script src="js/connections/editor.js"></script>
    
    <script src="js/ui.js"></script>
    <script src="js/export.js"></script>
    <script src="js/app.js"></script>
</body>
</html>